#:kivy 1.0

WindowManager:

<MainWindow>:
    name: "main_window"

<SecondWindow>:
    name: "second_window" 

<MainPanel>:

    image: image
    drawing_field: drawing_field

    BoxLayout:
        orientation: 'horizontal'
        

        DrawingField:
            selection: selection
            id: drawing_field

            size_hint: None, None
            size:  root.width * 0.7, root.height

            canvas.before:
                Color:
                    #rgba: 0.109, 0.949, 0.835, 0.8
                    rgba: 0, 0, 0, 1
                Rectangle:
                    size:  root.width * 0.7, root.height


            Image:
                id: image
                size_hint: None, None
                size: root.width * 0.7 * 0.8, root.height * 0.8
                pos: root.width * 0.7 * 0.1, root.height * 0.1

            LineRectangle:
                id: selection
                pos: root.width * 0.7 * 0.5 - 50, root.height * 0.5 - 50
                
                size: (100, 100)     
                  
        RelativeLayout:
            size_hint: None, None
            size:  root.width * 0.3, root.height

            canvas.before:
                Color:
                    rgba: 0.066, 0.674, 0.592, 0.8

                Rectangle:
                    size:  root.width * 0.35, root.height

            MyButton:
                size_hint: 0.7, 0.1
                pos_hint: {'center_x': .5, 'center_y': .1}
                text: "Submit"

                
                on_release:
                    app.root.main_to_second()


            MyButton:
                size_hint: 0.7, 0.1
                pos_hint: {'center_x': .5, 'center_y': .7}
                text: "Load image"

                on_release: 
                    on_release: root.load()
            
            MyButton:
                size_hint: 0.7, 0.1
                pos_hint: {'center_x': .5, 'center_y': .55}
                text: "Crop image"


                on_release: 
                    on_release: root.crop()
                


<LineRectangle>:
    canvas.after:
        Color:
            #rgba: 0.49, 0.49, 0.49, 1
            rgba: 1, 0, 0, 1
        Line:
            width: 1.75
            rectangle: (self.x, self.y, self.width, self.height)


<SecondPanel>:
    plot_field: plot_field

    BoxLayout:
        orientation: 'horizontal'
        

        BoxLayout:
            id: plot_field

            size_hint: None, None
            size:  root.width * 0.7, root.height
     
                  
        RelativeLayout:
            size_hint: None, None
            size:  root.width * 0.3, root.height

            canvas.before:
                Color:
                    rgba: 0.066, 0.674, 0.592, 0.8
                Rectangle:
                    size:  root.width * 0.35, root.height

            MyButton:
                size_hint: 0.7, 0.1
                pos_hint: {'center_x': .5, 'center_y': .2}
                text: "Go back"
                
                on_release: 
                    app.root.current = "main_window"
                    app.root.transition.direction = 'right'

            MyButton:
                size_hint: 0.7, 0.1
                pos_hint: {'center_x': .5, 'center_y': .1}
                text: "Submit"
                
                on_release: root.plot_test()

<MyButton@Button>:
    size: self.size
    pos: self.pos
    text: self.text

    #color: 1, 1, 1, 1
    #background_color: 0.427, 0.435, 0.431, 1
    #background_normal: ' '